{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","app.min.js","src/app/app.js","src/app/controllers/CollectCtrl.js","src/app/controllers/CreateCtrl.js","src/app/controllers/SelectCtrl.js","src/app/filters/featureFilter.js","src/app/filters/labelFilter.js","src/app/services/ModelService.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","_interopRequireDefault","obj","__esModule","default","_controllersSelectCtrl","_controllersSelectCtrl2","_controllersCollectCtrl","_controllersCollectCtrl2","_controllersCreateCtrl","_controllersCreateCtrl2","_servicesModelService","_servicesModelService2","_filtersFeatureFilter","_filtersFeatureFilter2","_filtersLabelFilter","_filtersLabelFilter2","angular","value","service","controller","filter","features","labels","getFeatures","getLabels","setConfig","_features","_labels","config","$httpProvider","$stateProvider","$urlRouterProvider","state","url","templateUrl","otherwise","./controllers/CollectCtrl","./controllers/CreateCtrl","./controllers/SelectCtrl","./filters/featureFilter","./filters/labelFilter","./services/ModelService",2,"Object","defineProperty","$scope","$filter","$location","$templateRequest","$sce","host","sharedConfig","ua","detect","parse","navigator","userAgent","sandbox","send","data","console","log","useragent","device","manufacturer","name","browser","family","major","text","sensor","replace","sensorData","substring","req","XMLHttpRequest","open","setRequestHeader","HTML","sensors","forEach","key","html","then","sensorHTML","trustAsHtml","fileLocation","feature","onreadystatechange","eval","client","responseText","window","push","timerRunning","start","deadline","$broadcast","stop","path",3,"ModelService","$watch","newVal","oldVal","scope","loadLabels","$query","response","series","results","concat","apply","map","values","x","indexOf","label","toLowerCase",4,"next",5,"_toConsumableArray","arr","Array","isArray","arr2","from","featureFilter","input","result","entry","Set","support","Modernizr",6,"labelFilter",7,"_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","protoProps","staticProps","prototype","$http","$q","this","$host","$inject","deferred","defer","get","resolve","promise","method","params","db","q"],"mappings":"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","file":"app.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n/*\n\tCopyright 2016 KIT Institute for Telematics TecO - David Greiner\n\tThis file is subject to the terms and conditions defined in\n\tfile 'LICENSE', which is part of this source code package.\n*/\n\n'use strict';\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _controllersSelectCtrl = require('./controllers/SelectCtrl');\n\nvar _controllersSelectCtrl2 = _interopRequireDefault(_controllersSelectCtrl);\n\nvar _controllersCollectCtrl = require('./controllers/CollectCtrl');\n\nvar _controllersCollectCtrl2 = _interopRequireDefault(_controllersCollectCtrl);\n\nvar _controllersCreateCtrl = require('./controllers/CreateCtrl');\n\nvar _controllersCreateCtrl2 = _interopRequireDefault(_controllersCreateCtrl);\n\nvar _servicesModelService = require('./services/ModelService');\n\nvar _servicesModelService2 = _interopRequireDefault(_servicesModelService);\n\nvar _filtersFeatureFilter = require('./filters/featureFilter');\n\nvar _filtersFeatureFilter2 = _interopRequireDefault(_filtersFeatureFilter);\n\nvar _filtersLabelFilter = require('./filters/labelFilter');\n\nvar _filtersLabelFilter2 = _interopRequireDefault(_filtersLabelFilter);\n\nangular.module('myApp', ['ui.bootstrap', 'ui.router', 'ngTagsInput', 'timer']).value('host', 'jactivity-influx.teco.edu').service('ModelService', _servicesModelService2['default']).controller('SelectCtrl', _controllersSelectCtrl2['default']).controller('CollectCtrl', _controllersCollectCtrl2['default']).controller('CreateCtrl', _controllersCreateCtrl2['default']).filter('feature', _filtersFeatureFilter2['default']).filter('label', _filtersLabelFilter2['default']).service('sharedConfig', function () {\n  var features = {};\n  var labels = {};\n\n  return {\n    getFeatures: function getFeatures() {\n      return features;\n    },\n    getLabels: function getLabels() {\n      return labels;\n    },\n    setConfig: function setConfig(_features, _labels) {\n      features = _features;\n      labels = _labels;\n    }\n  };\n}).config(['$httpProvider', '$stateProvider', '$urlRouterProvider', function ($httpProvider, $stateProvider, $urlRouterProvider) {\n\n  $stateProvider.state('select', {\n    url: '/select',\n    templateUrl: 'select.html',\n    controller: 'SelectCtrl'\n  }).state('collect', {\n    url: '/collect',\n    templateUrl: 'collect.html',\n    controller: 'CollectCtrl'\n  }).state('create', {\n    url: '/create',\n    templateUrl: 'create.html',\n    controller: 'CreateCtrl'\n  });\n\n  $urlRouterProvider.otherwise('/select');\n}]);\n\n},{\"./controllers/CollectCtrl\":2,\"./controllers/CreateCtrl\":3,\"./controllers/SelectCtrl\":4,\"./filters/featureFilter\":5,\"./filters/labelFilter\":6,\"./services/ModelService\":7}],2:[function(require,module,exports){\n/*\n\tCopyright 2016 KIT Institute for Telematics TecO - David Greiner\n\tThis file is subject to the terms and conditions defined in\n\tfile 'LICENSE', which is part of this source code package.\n*/\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports[\"default\"] = function ($scope, $filter, $location, $templateRequest, $sce, host, sharedConfig) {\n  'ngInject';\n\n  /* Get previously defined features and labels */\n  var features = sharedConfig.getFeatures();\n  var labels = sharedConfig.getLabels();\n\n  /* Parse UserAgent using darcyclarke/Detect.js */\n  var ua = detect.parse(navigator.userAgent);\n\n  /* Sandbox for all feature collect scripts */\n  var sandbox = {\n    send: function send(data) {\n      console.log(data);\n      var useragent = ua.device.manufacturer + \"_\" + ua.device.name + \"_\" + ua.browser.family + \"_\" + ua.browser.major;\n      var text = data.sensor + \",label=\" + labels + \",useragent=\" + useragent.replace(/\\s/g, '') + \" \";\n      delete data.sensor;\n      for (var sensorData in data) {\n        text += sensorData + \"=\" + data[sensorData] + \",\";\n      }\n      text = text.substring(0, text.length - 1);\n      var req = new XMLHttpRequest();\n      req.open('POST', \"http://\" + host + \"/influxdb/write?db=jactivity\");\n      req.setRequestHeader(\"Content-Type\", \"text/plain;charset=UTF-8\");\n      req.send(text);\n    }\n  };\n\n  $scope.HTML = \"\";\n\n  var sensors = [];\n\n  features.forEach(function (key) {\n    if (typeof key.html != \"undefined\" && key.html !== \"\") {\n      console.log(\"html/\" + key.html);\n\n      $templateRequest(\"html/\" + key.html).then(function (html) {\n        $scope.sensorHTML = $sce.trustAsHtml(html);\n      });\n    }\n    //$scope.HTML = $scope.HTML + $templateCache.get(\"html/\" + key.html);\n    /*\n    \t\t// DOM: Create the script element\n    \t    var jsElm = document.createElement(\"script\");\n    \t    // set the type attribute\n    \t    jsElm.type = \"application/javascript\";\n    \t    // make the script element load file\n    \t    jsElm.src = \"scripts/\" + key.script;\n    \t    // finally insert the element to the body element in order to load the script\n    \t    document.body.appendChild(jsElm);\n      \t\tjsElm.onload = function() {\n     \t\t};*/\n    //inject.js(\"scripts/\" + key.script, function() {\n\n    var req = new XMLHttpRequest();\n    var fileLocation = '../sensors/' + key.feature + '/' + key.feature + '.js';\n    req.open('GET', fileLocation);\n    req.onreadystatechange = function () {\n      eval(client.responseText);\n      var sensor = new window[key.feature](sandbox);\n      sensors.push(sensor);\n    };\n    //});\n  });\n\n  $scope.timerRunning = false;\n\n  $scope.start = function (deadline) {\n    $scope.$broadcast('timer-start');\n    $scope.timerRunning = true;\n    sensors.forEach(function (sensor) {\n      sensor.start();\n    });\n  };\n\n  $scope.stop = function () {\n    console.log(\"stop\");\n    $scope.timerRunning = false;\n    sensors.forEach(function (sensor) {\n      sensor.stop();\n      delete window.sensor;\n    });\n    $location.path(\"/sensor\");\n  };\n};\n\nmodule.exports = exports[\"default\"];\n\n},{}],3:[function(require,module,exports){\n/*\n\tCopyright 2016 KIT Institute for Telematics TecO - David Greiner\n\tThis file is subject to the terms and conditions defined in\n\tfile 'LICENSE', which is part of this source code package.\n*/\n\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nexports['default'] = function ($scope, $filter, $location, ModelService, host, sharedConfig) {\n  'ngInject';\n  /* Parse UserAgent using darcyclarke/Detect.js */\n  $scope.ua = detect.parse(navigator.userAgent);\n\n  /* Get Features using AJAX and generate sensor dependency list */\n  $scope.features = [];\n  $scope.sensors = [];\n\n  ModelService.getFeatures().then(function (data) {\n    $scope.features = data.data;\n    $scope.sensors = $filter('feature')($scope.features.sensors);\n  });\n\n  /* Watch for newly selected features and change sensor depency list accordingly */\n  $scope.$watch('features', function (newVal, oldVal, scope) {\n    $scope.sensors = $filter('feature')($scope.features.sensors);\n  }, true);\n\n  /* Get Labels and prepare them using mbenford/ngTagsInput */\n  $scope.labels = [];\n\n  $scope.loadLabels = function ($query) {\n    return ModelService.getLabels().then(function (response) {\n      var series = response.data.results[0].series;\n      //var labels = response.data;\n      var data = [].concat.apply([], series.map(function (e) {\n        return e.values.filter(function (x) {\n          return x[0] === 'label';\n        }).map(function (x) {\n          return x[1];\n        });\n      })).filter(function (e, i, s) {\n        return s.indexOf(e) === i;\n      });\n      //const labels = [];\n      //var labels = series.map(e=>e.values.filter(x=>x[0]==='label').map(x=>x[1])).reduce((a,b)=>a.IndexOf(b)<0?a.concat(b):a);\n      var labels = data.map(function (e) {\n        return { name: e };\n      });\n      //series.forEach(e => e.values.forEach(v => { if (v[0] === 'label' && labels.indexOf(v[1]) === -1) labels.push({name: v[1]});}));\n      return labels.filter(function (label) {\n        return label.name.toLowerCase().indexOf($query.toLowerCase()) != -1;\n      });\n    });\n  };\n\n  function capitalizeFirstLetter(string) {\n    return string.charAt(0).toUpperCase() + string.slice(1);\n  }\n\n  function updateJavaScript() {\n    console.log(\"updateJavaScript\");\n    var jActivityTemplate = 'class jActivity {\\n      constructor(host) {\\n        this.host = host\\n        //if(localStorage.getItem(\"decisionTree\")) {\\n        //\\tresolve(localStorage.getItem(\\'decisionTree\\', xsl_file))\\n        //} else {\\n    \\t    this.XSL = new Promise((resolve, reject) => {\\n    \\t      var onSuccess = function(xsl_file) {\\n    \\t        localStorage.setItem(\\'decisionTree\\', xsl_file)\\n    \\t        resolve(xsl_file)\\n    \\t      }\\n    \\t      $.ajax({\\n    \\t        type: \"GET\",\\n    \\t        url: (\"http://\" + host + \"/transformationstyles/pmml2js_decision_tree.xsl\"),\\n    \\t        success: onSuccess\\n    \\t      })\\n    \\t    })\\n    \\t//}\\n\\n      }\\n\\n      %CLASSIFIER%\\n    }\\n\\n    class Classifier {\\n      constructor(sensors, callback, label, interval, host, XSL) {\\n        this.sensors = sensors\\n        this.callback = callback\\n        this.label = label\\n        this.interval = interval\\n        this.host = host\\n        this.XSL = XSL\\n        this.decisionTree = null\\n        const scope = this\\n        this.createDecisionTree(scope)\\n        this.dataset = {}\\n        window.setInterval((...args) => this.evaluateDataActivity(...args), interval)\\n      }\\n\\n      createDecisionTree(scope) {\\n        function onSuccess(data, XSL) {\\n          let model = $.parseXML(data.pop())\\n          let generated_code = transform(model, XSL)\\n          scope.decisionTree = eval(generated_code.textContent)\\n        }\\n        this.XSL.then(function(XSL) {\\n          $.ajax({\\n            type: \"POST\",\\n            url: (\"http://\" + scope.host + \"/ocpu/ocpu/library/jActivity2PMML/R/getPMML/json\"),\\n            data: \\'json_data={\"sensor\": \\' + JSON.stringify(scope.sensors) + \\',\"label\": \\' + JSON.stringify(scope.label) + \\',\"classifier\": \"rpart\"}\\',\\n            success: function(data) {\\n              onSuccess(data, XSL)\\n            },\\n            dataType: \"json\"\\n          })\\n        })\\n      }\\n\\n      evaluateDataActivity() {\\n        throw new Error(\"Not implemented\")\\n      }\\n\\n    }\\n';\n    var classifierTemplate = 'class %NAME%Classifier extends Classifier {\\n      constructor(callback, label, interval, host, XSL) {\\n        super(%FEATURES%, callback, label, interval, host, XSL)\\n        %INITIALIZE%\\n      }\\n\\n      %HELPERFUNCTIONS%\\n\\n      evaluateDataActivity() {\\n        let averageData = {}\\n\\n        for (var feature in this.dataset) {\\n          averageData[feature] = this.dataset[feature].reduce(function(a, b) {\\n            return a + b\\n          }, 0) / this.dataset[feature].length\\n          this.dataset[feature] = []\\n        }\\n\\n        if (this.decisionTree == null) return\\n\\n        let res = this.decisionTree.evaluate(averageData).result\\n\\n        if (res == null) return\\n\\n        this.callback(res.toLowerCase())\\n      }\\n    }';\n    var implementTemplate = 'let %NAME%Callback = function(result) {\\n      switch (result) {\\n        %LABELSWITCH%\\n      }\\n    }\\n\\n    let %NAME%Classifier = jactivity.%NAME%Classifier(%NAME%Callback, %LABELS%, 1000)\\n    ';\n\n    var features = $filter('filter')($scope.features.sensors, {\n      value: true\n    });\n    var labels = $scope.labels;\n    var initialize = \"\";\n    var helper = \"\";\n    var classifierJS = \"\";\n    var options = { presets: [\"es2015\"] };\n\n    classifierImpl += $scope.name.toLowerCase() + \"Classifier(callback, label, interval) {\\nreturn new \" + capitalizeFirstLetter($scope.name) + \"Classifier(callback, label, interval, this.host, this.XSL)\\n}\\n\";\n\n    features.forEach(function (key) {\n      $http.get('../sensors/' + key.feature + '/' + key.feature + '.initialize.js').then(function (response) {\n        initialize += response.data;\n        return $http.get('../sensors/' + key.feature + '/' + key.feature + '.helper.js');\n      }).then(function (response) {\n        help += response.data;\n      });\n    });\n    var replacementsClassifier = { \"%NAME%\": capitalizeFirstLetter($scope.name), \"%FEATURES%\": features, \"%INITIALIZE%\": initialize, \"%HELPERFUNCTIONS%\": helper };\n    classifierJS += classifierTemplate.replace(/%\\w+%/g, function (all) {\n      return replacementsClassifier[all] || all;\n    });\n    classifierJS += '\\n';\n\n    var replacementsjActivity = { \"%CLASSIFIER%\": classifierImpl };\n\n    var jactivityJS = jActivityTemplate.replace(/%\\w+%/g, function (all) {\n      return replacementsjActivity[all] || all;\n    });\n    var jActivity = jactivityJS + classifierJS;\n\n    var code = babel.transform(jActivity, options).code;\n  }\n};\n\nmodule.exports = exports['default'];\n\n},{}],4:[function(require,module,exports){\n/*\n\tCopyright 2016 KIT Institute for Telematics TecO - David Greiner\n\tThis file is subject to the terms and conditions defined in\n\tfile 'LICENSE', which is part of this source code package.\n*/\n\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nexports['default'] = function ($scope, $filter, $location, ModelService, host, sharedConfig) {\n  'ngInject';\n  /* Parse UserAgent using darcyclarke/Detect.js */\n  $scope.ua = detect.parse(navigator.userAgent);\n\n  /* Get Features using AJAX and generate sensor dependency list */\n  $scope.features = [];\n  $scope.sensors = [];\n\n  ModelService.getFeatures().then(function (data) {\n    $scope.features = data.data;\n    $scope.sensors = $filter('feature')($scope.features.sensors);\n  });\n\n  /* Watch for newly selected features and change sensor depency list accordingly */\n  $scope.$watch('features', function (newVal, oldVal, scope) {\n    $scope.sensors = $filter('feature')($scope.features.sensors);\n  }, true);\n\n  /* Get Labels and prepare them using mbenford/ngTagsInput */\n  $scope.labels = [];\n\n  $scope.loadLabels = function ($query) {\n    return ModelService.getLabels().then(function (response) {\n      var series = response.data.results[0].series;\n      //var labels = response.data;\n      var data = [].concat.apply([], series.map(function (e) {\n        return e.values.filter(function (x) {\n          return x[0] === 'label';\n        }).map(function (x) {\n          return x[1];\n        });\n      })).filter(function (e, i, s) {\n        return s.indexOf(e) === i;\n      });\n      //const labels = [];\n      //var labels = series.map(e=>e.values.filter(x=>x[0]==='label').map(x=>x[1])).reduce((a,b)=>a.IndexOf(b)<0?a.concat(b):a);\n      var labels = data.map(function (e) {\n        return { name: e };\n      });\n      //series.forEach(e => e.values.forEach(v => { if (v[0] === 'label' && labels.indexOf(v[1]) === -1) labels.push({name: v[1]});}));\n      return labels.filter(function (label) {\n        return label.name.toLowerCase().indexOf($query.toLowerCase()) != -1;\n      });\n    });\n  };\n\n  /* Advance to collect page */\n  $scope.next = function () {\n    /* Only pass on selected features */\n    var features = $filter('filter')($scope.features.sensors, {\n      value: true\n    });\n\n    sharedConfig.setConfig(features, $scope.labels);\n    $location.path(\"/collect\");\n  };\n};\n\nmodule.exports = exports['default'];\n\n},{}],5:[function(require,module,exports){\n/*\n\tCopyright 2016 KIT Institute for Telematics TecO - David Greiner\n\tThis file is subject to the terms and conditions defined in\n\tfile 'LICENSE', which is part of this source code package.\n*/\n\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = featureFilter;\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i]; return arr2; } else { return Array.from(arr); } }\n\nfunction featureFilter() {\n  return function (input) {\n    if (typeof input !== 'undefined') {\n      var result = [];\n      input.forEach(function (entry) {\n        if (entry.value === true) {\n          result.push(entry.feature);\n        }\n      });\n      result = [].concat(_toConsumableArray(new Set(result)));\n      var features = [];\n      result.forEach(function (entry) {\n        var feature = {};\n        feature.name = entry;\n        feature.support = Modernizr[entry];\n        features.push(feature);\n      });\n      return features;\n    }\n  };\n}\n\nmodule.exports = exports['default'];\n\n},{}],6:[function(require,module,exports){\n/*\n\tCopyright 2016 KIT Institute for Telematics TecO - David Greiner\n\tThis file is subject to the terms and conditions defined in\n\tfile 'LICENSE', which is part of this source code package.\n*/\n\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = labelFilter;\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i]; return arr2; } else { return Array.from(arr); } }\n\nfunction labelFilter() {\n  return function (input) {\n    if (typeof input !== 'undefined') {\n      var result = [];\n      input.forEach(function (entry) {\n        if (entry.value === true) {\n          result.concat(entry.sensors);\n        }\n      });\n      result = [].concat(_toConsumableArray(new Set(result)));\n      var sensors = [];\n      result.forEach(function (entry) {\n        var sensor = {};\n        sensor.name = entry;\n        sensor.support = Modernizr[entry];\n        sensors.push(sensor);\n      });\n      return sensors;\n    }\n  };\n}\n\nmodule.exports = exports['default'];\n\n},{}],7:[function(require,module,exports){\n/*\n\tCopyright 2016 KIT Institute for Telematics TecO - David Greiner\n\tThis file is subject to the terms and conditions defined in\n\tfile 'LICENSE', which is part of this source code package.\n*/\n\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar ModelService = (function () {\n\n  /*@ngInject*/\n\n  function ModelService($http, $q, host) {\n    _classCallCheck(this, ModelService);\n\n    this.$http = $http;\n    this.$q = $q;\n    this.$host = host;\n  }\n\n  _createClass(ModelService, [{\n    key: 'getFeatures',\n    value: function getFeatures() {\n      var deferred = this.$q.defer();\n      this.$http.get('http://' + this.$host + '/sensors/sensors.json').then(function (data) {\n        deferred.resolve(data);\n      });\n\n      return deferred.promise;\n    }\n  }, {\n    key: 'getLabels',\n    value: function getLabels() {\n      var deferred = this.$q.defer();\n      var req = {\n        method: 'GET',\n        url: 'http://' + this.$host + '/influxdb/query',\n        params: { db: 'jactivity',\n          q: 'SHOW TAG VALUES WITH KEY IN (label)' }\n      };\n      this.$http(req).then(function (data) {\n        deferred.resolve(data);\n      });\n\n      return deferred.promise;\n    }\n  }]);\n\n  return ModelService;\n})();\n\nexports['default'] = ModelService;\nmodule.exports = exports['default'];\n\n},{}]},{},[1])\n\n","/*\n\tCopyright 2016 KIT Institute for Telematics TecO - David Greiner\n\tThis file is subject to the terms and conditions defined in\n\tfile 'LICENSE', which is part of this source code package.\n*/\n\nimport SelectCtrl from './controllers/SelectCtrl';\nimport CollectCtrl from './controllers/CollectCtrl';\nimport CreateCtrl from './controllers/CreateCtrl';\nimport ModelService from './services/ModelService';\nimport featureFilter from './filters/featureFilter';\nimport labelFilter from './filters/labelFilter';\n\nangular.module('myApp', ['ui.bootstrap', 'ui.router', 'ngTagsInput', 'timer'])\n\t.value('host', 'jactivity-influx.teco.edu')\n\t.service('ModelService', ModelService)\n\t.controller('SelectCtrl', SelectCtrl)\n\t.controller('CollectCtrl', CollectCtrl)\n\t.controller('CreateCtrl', CreateCtrl)\n\t.filter('feature', featureFilter)\n\t.filter('label', labelFilter)\n\t.service('sharedConfig', function () {\n        var features = {};\n        var labels = {};\n\n        return {\n            getFeatures: function () {\n                return features;\n            },\n            getLabels: function () {\n                return labels;\n            },\n            setConfig: function(_features, _labels) {\n                features = _features;\n                labels = _labels;\n            }\n        };\n\t })\n\t.config(['$httpProvider', '$stateProvider', '$urlRouterProvider',\n  function($httpProvider, $stateProvider, $urlRouterProvider) {\n\n    $stateProvider\n      .state('select', {\n        url: '/select',\n        templateUrl: 'select.html',\n        controller: 'SelectCtrl'\n      })\n      .state('collect', {\n        url: '/collect',\n        templateUrl: 'collect.html',\n        controller: 'CollectCtrl',\n      })\n\t\t\t.state('create', {\n        url: '/create',\n        templateUrl: 'create.html',\n        controller: 'CreateCtrl',\n      });\n\n    $urlRouterProvider.otherwise('/select');\n  }\n]);\n","/*\n\tCopyright 2016 KIT Institute for Telematics TecO - David Greiner\n\tThis file is subject to the terms and conditions defined in\n\tfile 'LICENSE', which is part of this source code package.\n*/\n\nexport default function($scope, $filter, $location, $templateRequest, $sce, host, sharedConfig) {\n  'ngInject';\n\n  /* Get previously defined features and labels */\n  var features = sharedConfig.getFeatures();\n  var labels = sharedConfig.getLabels();\n\n  /* Parse UserAgent using darcyclarke/Detect.js */\n  var ua = detect.parse(navigator.userAgent);\n\n  /* Sandbox for all feature collect scripts */\n  var sandbox = {\n    send: function(data) {\n      console.log(data);\n      var useragent = ua.device.manufacturer + \"_\" + ua.device.name + \"_\" + ua.browser.family + \"_\" + ua.browser.major;\n      var text = data.sensor + \",label=\" + labels + \",useragent=\" + useragent.replace(/\\s/g,'') + \" \";\n      delete data.sensor;\n      for(var sensorData in data) {\n        text += sensorData + \"=\" + data[sensorData] + \",\";\n      }\n      text = text.substring(0, text.length - 1);\n      var req = new XMLHttpRequest();\n      req.open('POST', \"http://\" + host + \"/influxdb/write?db=jactivity\");\n      req.setRequestHeader(\"Content-Type\", \"text/plain;charset=UTF-8\");\n      req.send(text);\n    }\n  };\n\n  $scope.HTML = \"\";\n\n  var sensors = [];\n\n  features.forEach(function(key) {\n    if (typeof(key.html) != \"undefined\" && key.html !== \"\") {\n      console.log(\"html/\" + key.html);\n\n      $templateRequest(\"html/\" + key.html).then(function(html) {\n        $scope.sensorHTML = $sce.trustAsHtml(html);\n      });\n    }\n    //$scope.HTML = $scope.HTML + $templateCache.get(\"html/\" + key.html);\n    /*\n    \t\t// DOM: Create the script element\n    \t    var jsElm = document.createElement(\"script\");\n    \t    // set the type attribute\n    \t    jsElm.type = \"application/javascript\";\n    \t    // make the script element load file\n    \t    jsElm.src = \"scripts/\" + key.script;\n    \t    // finally insert the element to the body element in order to load the script\n    \t    document.body.appendChild(jsElm);\n\n\n    \t\tjsElm.onload = function() {\n\n    \t\t};*/\n    //inject.js(\"scripts/\" + key.script, function() {\n\n    var req = new XMLHttpRequest();\n    var fileLocation = '../sensors/' + key.feature + '/' + key.feature + '.js';\n    req.open('GET', fileLocation);\n    req.onreadystatechange = function() {\n      eval(client.responseText);\n      var sensor = new window[key.feature](sandbox);\n      sensors.push(sensor);\n    };\n    //});\n  });\n\n  $scope.timerRunning = false;\n\n  $scope.start = function(deadline) {\n    $scope.$broadcast('timer-start');\n    $scope.timerRunning = true;\n    sensors.forEach(function(sensor) {\n      sensor.start();\n    });\n  };\n\n  $scope.stop = function() {\n    console.log(\"stop\");\n    $scope.timerRunning = false;\n    sensors.forEach(function(sensor) {\n      sensor.stop();\n      delete window.sensor;\n    });\n    $location.path(\"/sensor\");\n  };\n\n}\n","/*\n\tCopyright 2016 KIT Institute for Telematics TecO - David Greiner\n\tThis file is subject to the terms and conditions defined in\n\tfile 'LICENSE', which is part of this source code package.\n*/\n\nexport default function($scope, $filter, $location, ModelService, host, sharedConfig) {\n  'ngInject';\n  /* Parse UserAgent using darcyclarke/Detect.js */\n  $scope.ua = detect.parse(navigator.userAgent);\n\n  /* Get Features using AJAX and generate sensor dependency list */\n  $scope.features = [];\n  $scope.sensors = [];\n\n  ModelService.getFeatures().then(function(data) {\n    $scope.features = data.data;\n    $scope.sensors = $filter('feature')($scope.features.sensors);\n  });\n\n  /* Watch for newly selected features and change sensor depency list accordingly */\n  $scope.$watch('features', function(newVal, oldVal, scope) {\n    $scope.sensors = $filter('feature')($scope.features.sensors);\n  }, true);\n\n\n  /* Get Labels and prepare them using mbenford/ngTagsInput */\n  $scope.labels = [];\n\n  $scope.loadLabels = function($query) {\n    return ModelService.getLabels().then(function(response) {\n\t  const series = response.data.results[0].series;\n      //var labels = response.data;\n      var data = [].concat.apply([], series.map(e=>e.values.filter(x=>x[0]==='label').map(x=>x[1]))).filter((e,i,s)=>s.indexOf(e)===i);\n      //const labels = [];\n      //var labels = series.map(e=>e.values.filter(x=>x[0]==='label').map(x=>x[1])).reduce((a,b)=>a.IndexOf(b)<0?a.concat(b):a);\n      var labels = data.map(e=> ({name:e}));\n\t  //series.forEach(e => e.values.forEach(v => { if (v[0] === 'label' && labels.indexOf(v[1]) === -1) labels.push({name: v[1]});}));\n      return labels.filter(function(label) {\n        return label.name.toLowerCase().indexOf($query.toLowerCase()) != -1;\n      });\n    });\n  };\n\n  function capitalizeFirstLetter(string) {\n    return string.charAt(0).toUpperCase() + string.slice(1);\n  }\n\n  function updateJavaScript() {\n    console.log(\"updateJavaScript\");\n    var jActivityTemplate = `class jActivity {\n      constructor(host) {\n        this.host = host\n        //if(localStorage.getItem(\"decisionTree\")) {\n        //\tresolve(localStorage.getItem('decisionTree', xsl_file))\n        //} else {\n    \t    this.XSL = new Promise((resolve, reject) => {\n    \t      var onSuccess = function(xsl_file) {\n    \t        localStorage.setItem('decisionTree', xsl_file)\n    \t        resolve(xsl_file)\n    \t      }\n    \t      $.ajax({\n    \t        type: \"GET\",\n    \t        url: (\"http://\" + host + \"/transformationstyles/pmml2js_decision_tree.xsl\"),\n    \t        success: onSuccess\n    \t      })\n    \t    })\n    \t//}\n\n      }\n\n      %CLASSIFIER%\n    }\n\n    class Classifier {\n      constructor(sensors, callback, label, interval, host, XSL) {\n        this.sensors = sensors\n        this.callback = callback\n        this.label = label\n        this.interval = interval\n        this.host = host\n        this.XSL = XSL\n        this.decisionTree = null\n        const scope = this\n        this.createDecisionTree(scope)\n        this.dataset = {}\n        window.setInterval((...args) => this.evaluateDataActivity(...args), interval)\n      }\n\n      createDecisionTree(scope) {\n        function onSuccess(data, XSL) {\n          let model = $.parseXML(data.pop())\n          let generated_code = transform(model, XSL)\n          scope.decisionTree = eval(generated_code.textContent)\n        }\n        this.XSL.then(function(XSL) {\n          $.ajax({\n            type: \"POST\",\n            url: (\"http://\" + scope.host + \"/ocpu/ocpu/library/jActivity2PMML/R/getPMML/json\"),\n            data: 'json_data={\"sensor\": ' + JSON.stringify(scope.sensors) + ',\"label\": ' + JSON.stringify(scope.label) + ',\"classifier\": \"rpart\"}',\n            success: function(data) {\n              onSuccess(data, XSL)\n            },\n            dataType: \"json\"\n          })\n        })\n      }\n\n      evaluateDataActivity() {\n        throw new Error(\"Not implemented\")\n      }\n\n    }\n`;\n    var classifierTemplate = `class %NAME%Classifier extends Classifier {\n      constructor(callback, label, interval, host, XSL) {\n        super(%FEATURES%, callback, label, interval, host, XSL)\n        %INITIALIZE%\n      }\n\n      %HELPERFUNCTIONS%\n\n      evaluateDataActivity() {\n        let averageData = {}\n\n        for (var feature in this.dataset) {\n          averageData[feature] = this.dataset[feature].reduce(function(a, b) {\n            return a + b\n          }, 0) / this.dataset[feature].length\n          this.dataset[feature] = []\n        }\n\n        if (this.decisionTree == null) return\n\n        let res = this.decisionTree.evaluate(averageData).result\n\n        if (res == null) return\n\n        this.callback(res.toLowerCase())\n      }\n    }`;\n    var implementTemplate = `let %NAME%Callback = function(result) {\n      switch (result) {\n        %LABELSWITCH%\n      }\n    }\n\n    let %NAME%Classifier = jactivity.%NAME%Classifier(%NAME%Callback, %LABELS%, 1000)\n    `;\n\n    var features = $filter('filter')($scope.features.sensors, {\n      value: true\n    });\n    var labels = $scope.labels;\n    var initialize = \"\";\n    var helper = \"\";\n    var classifierJS = \"\";\n    var options = {presets: [\"es2015\"]};\n\n    classifierImpl += $scope.name.toLowerCase() + \"Classifier(callback, label, interval) {\\nreturn new \" + capitalizeFirstLetter($scope.name) + \"Classifier(callback, label, interval, this.host, this.XSL)\\n}\\n\";\n\n    features.forEach(function(key) {\n      $http.get('../sensors/' + key.feature + '/' + key.feature + '.initialize.js')\n        .then(function(response) {\n           initialize += response.data;\n           return $http.get('../sensors/' + key.feature + '/' + key.feature + '.helper.js');\n        })\n        .then(function(response) {\n           help += response.data;\n        });\n    });\n    var replacementsClassifier = {\"%NAME%\":capitalizeFirstLetter($scope.name), \"%FEATURES%\":features, \"%INITIALIZE%\": initialize, \"%HELPERFUNCTIONS%\": helper};\n    classifierJS += classifierTemplate.replace(/%\\w+%/g, function(all) {\n       return replacementsClassifier[all] || all;\n    });\n    classifierJS += '\\n';\n\n    var replacementsjActivity = {\"%CLASSIFIER%\":classifierImpl};\n\n    var jactivityJS = jActivityTemplate.replace(/%\\w+%/g, function(all) {\n       return replacementsjActivity[all] || all;\n    });\n    var jActivity = jactivityJS + classifierJS;\n\n    var code = babel.transform(jActivity, options).code;\n  }\n\n}\n","/*\n\tCopyright 2016 KIT Institute for Telematics TecO - David Greiner\n\tThis file is subject to the terms and conditions defined in\n\tfile 'LICENSE', which is part of this source code package.\n*/\n\nexport default function($scope, $filter, $location, ModelService, host, sharedConfig) {\n  'ngInject';\n  /* Parse UserAgent using darcyclarke/Detect.js */\n  $scope.ua = detect.parse(navigator.userAgent);\n\n  /* Get Features using AJAX and generate sensor dependency list */\n  $scope.features = [];\n  $scope.sensors = [];\n\n  ModelService.getFeatures().then(function(data) {\n    $scope.features = data.data;\n    $scope.sensors = $filter('feature')($scope.features.sensors);\n  });\n\n  /* Watch for newly selected features and change sensor depency list accordingly */\n  $scope.$watch('features', function(newVal, oldVal, scope) {\n    $scope.sensors = $filter('feature')($scope.features.sensors);\n  }, true);\n\n\n  /* Get Labels and prepare them using mbenford/ngTagsInput */\n  $scope.labels = [];\n\n  $scope.loadLabels = function($query) {\n    return ModelService.getLabels().then(function(response) {\n\t  const series = response.data.results[0].series;\n      //var labels = response.data;\n      var data = [].concat.apply([], series.map(e=>e.values.filter(x=>x[0]==='label').map(x=>x[1]))).filter((e,i,s)=>s.indexOf(e)===i);\n      //const labels = [];\n      //var labels = series.map(e=>e.values.filter(x=>x[0]==='label').map(x=>x[1])).reduce((a,b)=>a.IndexOf(b)<0?a.concat(b):a);\n      var labels = data.map(e=> ({name:e}));\n\t  //series.forEach(e => e.values.forEach(v => { if (v[0] === 'label' && labels.indexOf(v[1]) === -1) labels.push({name: v[1]});}));\n      return labels.filter(function(label) {\n        return label.name.toLowerCase().indexOf($query.toLowerCase()) != -1;\n      });\n    });\n  };\n\n  /* Advance to collect page */\n  $scope.next = function() {\n    /* Only pass on selected features */\n    var features = $filter('filter')($scope.features.sensors, {\n      value: true\n    });\n\n    sharedConfig.setConfig(features, $scope.labels);\n    $location.path(\"/collect\");\n  };\n\n}\n","/*\n\tCopyright 2016 KIT Institute for Telematics TecO - David Greiner\n\tThis file is subject to the terms and conditions defined in\n\tfile 'LICENSE', which is part of this source code package.\n*/\n\nexport default function featureFilter() {\n  return function(input) {\n    if (typeof input !== 'undefined') {\n      var result = [];\n      input.forEach(function(entry) {\n        if (entry.value === true) {\n          result.push(entry.feature);\n        }\n      });\n      result = [...new Set(result)];\n      var features = [];\n      result.forEach(function(entry) {\n        var feature = {};\n        feature.name = entry;\n        feature.support = Modernizr[entry];\n        features.push(feature);\n      });\n      return features;\n    }\n  };\n}\n","/*\n\tCopyright 2016 KIT Institute for Telematics TecO - David Greiner\n\tThis file is subject to the terms and conditions defined in\n\tfile 'LICENSE', which is part of this source code package.\n*/\n\nexport default function labelFilter() {\n  return function(input) {\n    if (typeof input !== 'undefined') {\n      var result = [];\n      input.forEach(function(entry) {\n        if (entry.value === true) {\n          result.concat(entry.sensors);\n        }\n      });\n      result = [...new Set(result)];\n      var sensors = [];\n      result.forEach(function(entry) {\n        var sensor = {};\n        sensor.name = entry;\n        sensor.support = Modernizr[entry];\n        sensors.push(sensor);\n      });\n      return sensors;\n    }\n  };\n}\n","/*\n\tCopyright 2016 KIT Institute for Telematics TecO - David Greiner\n\tThis file is subject to the terms and conditions defined in\n\tfile 'LICENSE', which is part of this source code package.\n*/\n\nexport default class ModelService {\n\n  /*@ngInject*/\n  constructor($http, $q, host) {\n    this.$http = $http;\n    this.$q = $q;\n    this.$host = host;\n  }\n\n  getFeatures() {\n    var deferred = this.$q.defer();\n    this.$http.get('http://' + this.$host + '/sensors/sensors.json').then(function(data) {\n      deferred.resolve(data);\n    });\n\n    return deferred.promise;\n  }\n  getLabels() {\n    var deferred = this.$q.defer();\n    var req = {\n\t  method: 'GET',\n\t  url: 'http://' + this.$host + '/influxdb/query',\n\t  params: { db: 'jactivity',\n\t\t  \t\tq: 'SHOW TAG VALUES WITH KEY IN (label)' }\n\t};\n    this.$http(req).then(function(data) {\n      deferred.resolve(data);\n    });\n\n    return deferred.promise;\n  }\n}\n"],"sourceRoot":"/source/"}