!function e(t,r,n){function o(u,a){if(!r[u]){if(!t[u]){var l="function"==typeof require&&require;if(!a&&l)return l(u,!0);if(s)return s(u,!0);var i=new Error("Cannot find module '"+u+"'");throw i.code="MODULE_NOT_FOUND",i}var c=r[u]={exports:{}};t[u][0].call(c.exports,function(e){var r=t[u][1][e];return o(r?r:e)},c,c.exports,e,t,r,n)}return r[u].exports}for(var s="function"==typeof require&&require,u=0;u<n.length;u++)o(n[u]);return o}({1:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var o=e("./controllers/SelectCtrl"),s=n(o),u=e("./controllers/CollectCtrl"),a=n(u),l=e("./services/ModelService"),i=n(l),c=e("./filters/featureFilter"),f=n(c),p=e("./filters/labelFilter"),d=n(p);angular.module("myApp",["ui.bootstrap","ui.router","ngTagsInput","timer"]).value("host","jactivity-influx.teco.edu").service("ModelService",i["default"]).controller("SelectCtrl",s["default"]).controller("CollectCtrl",a["default"]).filter("feature",f["default"]).filter("label",d["default"]).service("sharedConfig",function(){var e={},t={};return{getFeatures:function(){return e},getLabels:function(){return t},setConfig:function(r,n){e=r,t=n}}}).config(["$httpProvider","$stateProvider","$urlRouterProvider",function(e,t,r){t.state("select",{url:"/select",templateUrl:"select.html",controller:"SelectCtrl"}).state("collect",{url:"/collect",templateUrl:"collect.html",controller:"CollectCtrl"}),r.otherwise("/select")}])},{"./controllers/CollectCtrl":2,"./controllers/SelectCtrl":3,"./filters/featureFilter":4,"./filters/labelFilter":5,"./services/ModelService":6}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=["$scope","$filter","$location","$templateRequest","$sce","host","sharedConfig",function($scope,$filter,$location,$templateRequest,$sce,host,sharedConfig){"ngInject";var features=sharedConfig.getFeatures(),labels=sharedConfig.getLabels(),ua=detect.parse(navigator.userAgent),sandbox={send:function(e){console.log(e);var t=ua.device.manufacturer+"_"+ua.device.name+"_"+ua.browser.family+"_"+ua.browser.major,r=e.sensor+",label="+labels+",useragent="+t.replace(/\s/g,"")+" ";delete e.sensor;for(var n in e)r+=n+"="+e[n]+",";r=r.substring(0,r.length-1);var o=new XMLHttpRequest;o.open("POST","http://"+host+"/influxdb/write?db=jactivity"),o.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),o.send(r)}};$scope.HTML="";var sensors=[];features.forEach(function(key){"undefined"!=typeof key.html&&""!==key.html&&(console.log("html/"+key.html),$templateRequest("html/"+key.html).then(function(e){$scope.sensorHTML=$sce.trustAsHtml(e)}));var req=new XMLHttpRequest,fileLocation="../sensors/"+key.feature+"/"+key.feature+".js";req.open("GET",fileLocation),req.onreadystatechange=function(){eval(client.responseText);var sensor=new window[key.feature](sandbox);sensors.push(sensor)}}),$scope.timerRunning=!1,$scope.start=function(e){$scope.$broadcast("timer-start"),$scope.timerRunning=!0,sensors.forEach(function(e){e.start()})},$scope.stop=function(){console.log("stop"),$scope.timerRunning=!1,sensors.forEach(function(e){e.stop(),delete window.sensor}),$location.path("/sensor")}}],module.exports=exports["default"]},{}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=["$scope","$filter","$location","ModelService","host","sharedConfig",function(e,t,r,n,o,s){"ngInject";e.ua=detect.parse(navigator.userAgent),e.features=[],e.sensors=[],n.getFeatures().then(function(r){e.features=r.data,e.sensors=t("feature")(e.features.sensors)}),e.$watch("features",function(r,n,o){e.sensors=t("feature")(e.features.sensors)},!0),e.labels=[],e.loadLabels=function(e){return n.getLabels().then(function(t){var r=t.data.results[0].series,n=[].concat.apply([],r.map(function(e){return e.values.filter(function(e){return"label"===e[0]}).map(function(e){return e[1]})})).filter(function(e,t,r){return r.indexOf(e)===t}),o=n.map(function(e){return{name:e}});return o.filter(function(t){return-1!=t.name.toLowerCase().indexOf(e.toLowerCase())})})},e.next=function(){var n=t("filter")(e.features.sensors,{value:!0});s.setConfig(n,e.labels),r.path("/collect")}}],t.exports=r["default"]},{}],4:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(){return function(e){if("undefined"!=typeof e){var t=[];e.forEach(function(e){e.value===!0&&t.push(e.feature)}),t=[].concat(n(new Set(t)));var r=[];return t.forEach(function(e){var t={};t.name=e,t.support=Modernizr[e],r.push(t)}),r}}}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=o,t.exports=r["default"]},{}],5:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(){return function(e){if("undefined"!=typeof e){var t=[];e.forEach(function(e){e.value===!0&&t.concat(e.sensors)}),t=[].concat(n(new Set(t)));var r=[];return t.forEach(function(e){var t={};t.name=e,t.support=Modernizr[e],r.push(t)}),r}}}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=o,t.exports=r["default"]},{}],6:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function(){function e(t,r,o){n(this,e),this.$http=t,this.$q=r,this.$host=o}return e.$inject=["$http","$q","host"],o(e,[{key:"getFeatures",value:function(){var e=this.$q.defer();return this.$http.get("http://"+this.$host+"/sensors/sensors.json").then(function(t){e.resolve(t)}),e.promise}},{key:"getLabels",value:function(){var e=this.$q.defer(),t={method:"GET",url:"http://"+this.$host+"/influxdb/query",params:{db:"jactivity",q:"SHOW TAG VALUES WITH KEY IN (label)"}};return this.$http(t).then(function(t){e.resolve(t)}),e.promise}}]),e}();r["default"]=s,t.exports=r["default"]},{}]},{},[1]);
//# sourceMappingURL=app.min.js.map
